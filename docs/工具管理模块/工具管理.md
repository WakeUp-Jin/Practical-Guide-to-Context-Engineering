# 1ã€ä»€ä¹ˆæ˜¯ MCP å’Œ Tool
![MCPå’ŒTool](./image/image%20(10).png)

+ **MCP**ï¼šæ˜¯ä¸€ä»½**è§„èŒƒ/åè®®**ï¼Œè§„å®šäº†â€œå®¹å™¨è¦æ€ä¹ˆé•¿ã€é‡Œé¢çš„åŠŸèƒ½è¦æ€ä¹ˆæè¿°ã€è°ƒç”¨è¦æ€ä¹ˆæ²Ÿé€šâ€ã€‚å°±åƒ HTTP è§„èŒƒæœ¬èº«ï¼Œä¸æ˜¯ä¸€ä¸ªæœåŠ¡ï¼Œè€Œæ˜¯å¤§å®¶éƒ½å¾—éµå®ˆçš„è¯­è¨€ã€‚
+ **MCPæœåŠ¡å™¨**ï¼šæ˜¯**è§„èŒƒçš„ä¸€ä¸ªå®ç°**ï¼Œå®ƒä½œä¸ºä¸€ä¸ªå®¹å™¨ï¼Œå¯ä»¥å¯¹å¤–æš´éœ²å¾ˆå¤šèƒ½åŠ›ï¼ˆTool / Resource / Eventï¼‰ã€‚å°±åƒä¸€ä¸ªè·‘åœ¨ç«¯å£ä¸Šçš„ Web æœåŠ¡å™¨ï¼Œéµå¾ª HTTP åè®®ï¼Œé‡Œé¢å¯ä»¥æœ‰å¾ˆå¤š APIã€‚
+ **Tool**ï¼šæ˜¯**å®¹å™¨é‡Œçš„åŠŸèƒ½å•å…ƒ**ï¼Œä¸€èˆ¬è¡¨ç°ä¸ºä¸€ä¸ªâ€œå‡½æ•°â€æˆ–è€…â€œæ¥å£â€ã€‚è°ƒç”¨çš„æ—¶å€™å°±æ˜¯ä¼ å‚æ‰§è¡Œï¼Œè¿”å›ç»“æœã€‚

Tool ç›®å‰ä½¿ç”¨èµ·æ¥æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œåœ¨é¡¹ç›®ä¸­æŒ‰ç…§è§„èŒƒå†™ä¸€ä¸ªå‡½æ•°ï¼Œå°†è¿™ä¸ªå‡½æ•°ä»¥ tool å‚æ•°çš„å½¢å¼ä¼ é€’ç»™å¤§æ¨¡å‹ï¼Œå¤§æ¨¡å‹è¾“å‡ºå‡½æ•°åä¹‹åï¼Œç³»ç»Ÿè°ƒç”¨è¯¥å‡½æ•°

å¦‚æœä½ éœ€è¦æ­å»ºä¸€å¥—å·¥å…·é›†çš„æœåŠ¡ï¼Œæƒ³è¦æä¾›ç»™å¤šä¸ªé¡¹ç›®ä½¿ç”¨ï¼Œæä¾›ç»™åˆ«äººä½¿ç”¨ï¼Œæä¾›ç»™æ”¯æŒ MCP çš„å®¢æˆ·ç«¯ä½¿ç”¨ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥éµå®ˆ MCP åè®®æ­å»º MCP çš„æœåŠ¡

**æˆ‘è§‰å¾— MCP å’Œ Tool æœ¬è´¨æ˜¯å·®ä¸å¤šçš„ï¼Œå°±æ˜¯ç»™æ¨¡å‹æä¾›â€œå¤–éƒ¨èƒ½åŠ›â€çš„ä½œç”¨**ï¼Œæ ¹æ®è‡ªå·±çš„æƒ…å†µå’Œèƒ½åŠ›æ¥é€‰æ‹©ä½¿ç”¨æ˜¯æ¯”è¾ƒå¥½çš„

# 2ã€å·¥å…·å®šä¹‰è§„èŒƒ
å‚è€ƒï¼š[https://www.yuque.com/u29239513/wyl4ok/kazggbpdgpzfv0e7](https://www.yuque.com/u29239513/wyl4ok/kazggbpdgpzfv0e7)

åœ¨å®šä¹‰å·¥å…·çš„æ—¶å€™ï¼Œæœ€é‡è¦çš„å°±æ˜¯**å·¥å…·çš„æè¿°å’Œå·¥å…·è°ƒç”¨éœ€è¦çš„å‚æ•°**

1. **å·¥å…·çš„æè¿°ï¼š**æ¸…æ™°çš„å·¥å…·æè¿°å¯ä»¥æé«˜å¤§æ¨¡å‹å·¥å…·è°ƒç”¨çš„æˆåŠŸç‡
2. **å·¥å…·çš„å‚æ•°ï¼š**æè¿°å‚æ•°å·¥å…·çš„æ—¶å€™ï¼Œè¦ä»å‚æ•°åï¼Œå‚æ•°ç±»å‹ï¼Œå‚æ•°æè¿°ç­‰å°½å¯èƒ½å¤šçš„æ–¹é¢è®²è¿™ä¸ªå‚æ•°è¡¨è¾¾çš„æ›´æ¸…æ¥šï¼Œè¿™æ ·åœ¨å¤§æ¨¡å‹è¾“å‡ºå·¥å…·å‚æ•°çš„æ—¶å€™ä¼šå‡†ç¡®å’Œå¾ˆå¤š
3. **å·¥å…·çš„æ‰§è¡Œå‡½æ•°ï¼š**è¿™ä¸ªæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå¤§æ¨¡å‹è¾“å‡ºåˆé€‚çš„å·¥å…·è°ƒç”¨æŒ‡ä»¤ä¹‹åï¼Œç³»ç»Ÿæ‰§è¡Œè¯¥å‡½æ•°



## 2.1ã€å·¥å…·(Tool)çš„ç±»å‹å®šä¹‰ï¼š
+ **description****ğŸŒŸ****ï¼šå·¥å…·çš„æè¿°**
+ **parameters****ğŸŒŸ****ï¼ˆToolParameterDefinitionï¼‰ï¼šå·¥å…·çš„å‚æ•°å®šä¹‰**
+ categoryï¼šå·¥å…·åˆ†ç±»
+ versionï¼šå·¥å…·ç‰ˆæœ¬
+ **handlerï¼šå·¥å…·çš„æ‰§è¡Œå‡½æ•°ï¼Œè¿™ä¸ªä¸éœ€è¦ä¼ é€’ç»™å¤§æ¨¡å‹ï¼Œè€Œæ˜¯ä½œä¸ºç³»ç»Ÿå†…éƒ¨æ‰§è¡Œçš„**
+ agentAccessibleï¼šæ§åˆ¶å·¥å…·æ˜¯å¦å¯¹ä»£ç†å¯è§
+ internalï¼šæ ‡è®°ä¸ºå†…éƒ¨å·¥å…·ç±»
+ Purposeï¼šæè¿°äº†å·¥å…·çš„æ ¸å¿ƒç›®çš„å’ŒåŠŸèƒ½å®šä½ï¼Œå®ƒå›ç­”â€è¿™ä¸ªå·¥å…·ä¸ºä»€ä¹ˆå­˜åœ¨â€œä»¥åŠâ€å®ƒè§£å†³å•¦ä»€ä¹ˆé—®é¢˜â€ï¼Œå…¶æ˜¯ä¸€ä¸ªå®è§‚çš„åŠŸèƒ½æè¿°ï¼Œä¾‹å¦‚ï¼špurpose: 'Perform semantic search over stored memory entries to retrieve relevant knowledge and reasoning traces that can inform current decision-making.'
+ UseCaseï¼šæè¿°äº†å·¥å…·çš„å…·ä½“ä½¿ç”¨åœºæ™¯å’Œé€‚ç”¨æ¡ä»¶ï¼Œå®ƒå›ç­”äº†â€œåœ¨ä»€ä¹ˆæƒ…å†µä¸‹åº”è¯¥ä½¿ç”¨è¿™ä¸ªå·¥å…·â€ä»¥åŠâ€œå¦‚ä½•æ­£ç¡®çš„ä½¿ç”¨è¿™ä¸ªå·¥å…·â€ï¼Œå…¶æ›´å¤šçš„å…³æ³¨åº”ç”¨åœºæ™¯å’Œé€‚ç”¨æ¡ä»¶ï¼Œä¾‹å¦‚ï¼šuseCase: 'Use when you need to find previously stored knowledge, code patterns, or technical information that may be relevant to answering current questions or solving problems.'

> `description` å’Œ `paramenters`ã€`**handler**`æ˜¯å·¥å…·å®šä¹‰å¿…é¡»è¦çš„å‚æ•°ï¼Œå…¶ä»–çš„å‚æ•°æ˜¯æ ¹æ®æƒ…å†µé€‰æ‹©çš„
>
> handler æ˜¯å·¥å…·çš„æ‰§è¡Œå‡½æ•°ï¼Œè¿™ä¸ªä¸ç”¨ä½œä¸ºå·¥å…·å®šä¹‰ä¿¡æ¯ä¼ é€’ç»™å¤§æ¨¡å‹
>



## 2.2ã€å·¥å…·å‚æ•°(ToolParameterDefinition)çš„ç±»å‹å®šä¹‰ï¼š
+ **type**ï¼šå®šä¹‰å‚æ•°æ•°æ®ç±»å‹ï¼Œå¦‚ï¼š`'string' | 'number' | 'boolean' | 'object' | 'array'`
+ **description**:æä¾›å‚æ•°çš„äººç±»å¯è¯»æè¿°ï¼Œå¸®åŠ© LLM ç†è§£å‚æ•°çš„ç”¨é€”
+ minimum ï½œ maximumï¼šå®šä¹‰å‚æ•°æ•°å€¼çš„æœ€å°å€¼å’Œæœ€å¤§å€¼
+ minItems ï½œ maxItemsï¼šå®šä¹‰æ•°ç»„å‚æ•°çš„æœ€å°å’Œæœ€å¤§å…ƒç´ æ•°é‡
+ minLength | maxLengthï¼šå®šä¹‰å­—ç¬¦ä¸²å‚æ•°çš„æœ€å°å’Œæœ€å¤§é•¿åº¦
+ oneOfï¼šå®šä¹‰å‚æ•°å¿…é¡»åŒ¹é…å¤šä¸ª Schema ä¸­çš„ä¸€ä¸ª
+ additionalPropertiesï¼šç¦æ­¢å¯¹è±¡å‚æ•°åŒ…å«é¢å¤–å±æ€§
+ itemsï¼šå®šä¹‰æ•°ç»„å…ƒç´ çš„ç±»å‹
+ enumï¼šå®šä¹‰å‚æ•°çš„å¯èƒ½å–å€¼
+ defaultï¼šå®šä¹‰å‚æ•°çš„é»˜è®¤å€¼

> `type` å’Œ `description` æ˜¯å¿…é¡»çš„ï¼Œè¿™ä¸ªæ˜¯å‚æ•°å®šä¹‰çš„åŸºæœ¬å…ƒç´ ï¼Œå¹¶ä¸”å‚æ•°å‘½åä¹Ÿå¯ä»¥æˆä¸ºå‚æ•°çš„æè¿°
>



ä¸‹é¢æ˜¯ä¸€ä¸ªå·¥å…·å®šä¹‰å®Œæ•´çš„æ¡ˆä¾‹ï¼š

```typescript
export const memoryOperationTool: InternalTool = {
	name: 'memory_operation',
	category: 'memory',
	internal: true,
	description:
		'Process extracted knowledge and determine memory operations (ADD, UPDATE, DELETE, NONE) using LLM-powered intelligent reasoning and similarity analysis with existing memories.',
	version: '2.0.0', // version
	parameters: {
		type: 'object',
		properties: {
			extractedFacts: {
				type: 'array',
				description:
					'Array of knowledge facts already extracted from interactions, containing technical details, code patterns, or implementation information.',
				items: {
					type: 'string',
				},
			},
			existingMemories: {
				type: 'array',
				description: 'Array of existing memory entries to compare against for similarity analysis.',
				items: {
					type: 'object',
					properties: {
						id: {
							type: 'string',
							description: 'Unique identifier of the existing memory',
						},
						text: {
							type: 'string',
							description: 'Content of the existing memory',
						},
						metadata: {
							type: 'object',
							description: 'Optional metadata for the memory',
						},
					},
					required: ['id', 'text'],
				},
			},
		},
		required: ['extractedFacts'],
	},
	handler: memoryOperationHandler
	},
};

//å·¥å…·è°ƒç”¨å‡½æ•°
const memoryOperationHandler = async (
	args: MemoryOperationArgs,
	context?: InternalToolContext
): Promise<MemoryOperationResult> => {
	// TODO: Implement intelligent reasoning logic to determine memory operations
	// Example placeholder return structure
	return {
		operations: [], // List of { operation: 'ADD' | 'UPDATE' | 'DELETE' | 'NONE', fact, memoryId? }
	};
};
```



## 2.3ã€å·¥å…·æ‰§è¡Œå‡½æ•°å®šä¹‰
ä¸Šé¢å·¥å…·å®šä¹‰å’Œå·¥å…·å‚æ•°å®šä¹‰è¿™äº›éƒ½åœ¨ä½œä¸º tool å‚æ•°ä¼ é€’ç»™ LLM ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ LLM æ ¹æ®ä¼ é€’çš„å·¥å…·æè¿°å’Œç”¨æˆ·è¾“å…¥æŒ‘é€‰å‡ºæ¥ä¸€ä¸ªåˆé€‚çš„å·¥å…·ï¼Œ**ä½†æ˜¯å¤§æ¨¡å‹ä¸è´Ÿè´£æ‰§è¡Œå·¥å…·å‡½æ•°ï¼Œå®ƒåªè´Ÿè´£è¾“å‡ºå·¥å…·åç§°å’Œå·¥å…·å‚æ•°**

å¯¹äºå·¥å…·æ‰§è¡Œå‡½æ•°çš„å®šä¹‰ï¼Œå¯ä»¥ç®€å•çš„æ ¹æ®å·¥å…·å‚æ•°å»å®šä¹‰çš„ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€äº›å¸¸è§„å®šä¹‰æ–¹æ³•ï¼Œå¯ä»¥å‚è€ƒ

å·¥å…·çš„æ‰§è¡Œå‡½æ•°ï¼Œä¼šå®šä¹‰ä¸¤ä¸ªå‚æ•°å¯¹è±¡

+ **arge**ï¼šå‡½æ•°æ‰§è¡Œéœ€è¦çš„å‚æ•°å¯¹è±¡
+ **context ï½œmetadata**ï¼šå‡½æ•°çš„å…ƒä¿¡æ¯

ä¸€èˆ¬æ¥è¯´ï¼Œarge æ˜¯åˆšåˆšä¼ å…¥å·¥å…·å‚æ•°çš„ç±»å‹ï¼Œæ˜¯å·¥å…·æ‰§è¡Œå‡½æ•°çš„åŸºæœ¬å‚æ•°ï¼Œè€Œ context æˆ–è€… metadata æ˜¯å±äºè¾…åŠ©å‚æ•°ï¼Œå¤§éƒ¨åˆ†æƒ…å†µæ˜¯ç”¨äºç›‘æ§å’Œç»Ÿè®¡çš„ï¼Œæ˜¯å¯é€‰çš„ï¼Œæ²¡æœ‰è¿™ä¸ªä¹Ÿä¸å½±å“å‡½æ•°çš„ä¸»åŠŸèƒ½æ‰§è¡Œ



ä¾‹å¦‚ä¸Šé¢çš„å®šä¹‰æ¡ˆä¾‹ä¸­çš„`memoryOperationHandler`ï¼š

```typescript
//ä¸»è¦å‚æ•°-å‚æ•°å¯¹è±¡
export interface MemoryOperationArgs {
	extractedFacts: string[];
	existingMemories?: {
		id: string;
		text: string;
		metadata?: Record<string, any>;
	}[];
}

//è¾…åŠ©å‚æ•°-å…ƒä¿¡æ¯
export interface InternalToolContext {
    toolName: string;
    startTime: number;
    sessionId: string | undefined;
    userId?: string;
    metadata: Record<string, any> | undefined;
    
    // æœåŠ¡ä¾èµ–
    services?: {
        embeddingManager?: EmbeddingManager;
        vectorStoreManager?: VectorStoreManager;
        llmService?: ILLMService;
        knowledgeGraphManager?: KnowledgeGraphManager;
    };
}

//å·¥å…·æ‰§è¡Œå‡½æ•°
const memoryOperationHandler = async (
	args: MemoryOperationArgs,
	context?: InternalToolContext
): Promise<MemoryOperationResult> => {
	// TODO: Implement intelligent reasoning logic to determine memory operations
	// Example placeholder return structure
	return {
		operations: [], // List of { operation: 'ADD' | 'UPDATE' | 'DELETE' | 'NONE', fact, memoryId? }
	};
};
```

# ä¸‰ã€å·¥å…·çš„å®šä½
## 3.1ã€Agent ç³»ç»Ÿçš„æ ¸å¿ƒ
Excalidraw æ–‡ä»¶ï¼š[https://gcntfv628ebr.feishu.cn/file/Be6EbeZvmoN6BTxijSecQGuIn5g](https://gcntfv628ebr.feishu.cn/file/Be6EbeZvmoN6BTxijSecQGuIn5g)

![ç³»ç»Ÿæ ¸å¿ƒè®¾è®¡](./image/image%20(11).png)

ä¹‹å‰çš„ç³»ç»Ÿçš„è®¾è®¡ï¼Œéƒ½æ˜¯å›´ç»•ä¸€ä¸ªâ€œæœ‰å‘æ— ç¯å›¾(DAG)â€çš„ç†å¿µæ¥è®¾è®¡çš„ï¼Œæ ¸å¿ƒæ¨¡å—ä¸»è¦æ˜¯ç”±å¾ªç¯å’Œæ¡ä»¶åˆ¤æ–­ç»„æˆï¼Œå¤æ‚çš„ç³»ç»Ÿä¹Ÿåªæ˜¯å¤šä¸ªå¾ªç¯å’Œå¤šä¸ªæ¡ä»¶åˆ¤æ–­ç»„æˆï¼Œåœ¨æ­¤åŸºç¡€ä¸Šå¢åŠ å¯è§‚å¯Ÿæ€§ï¼Œæ¨¡å—åŒ–ï¼Œé‡è¯•ï¼Œç®¡ç†ç­‰åŠŸèƒ½ï¼Œæˆä¸ºä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿ



è€Œæœ‰äº† LLM ä¹‹åï¼Œè®¾è®¡ Agent çš„ç³»ç»Ÿæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æš‚æ—¶æ”¾ä¸‹â€œæœ‰å‘æ— ç¯å›¾(DAG)â€çš„æƒ³æ³•ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä¸ºæ¯ä¸€ä¸ªæ­¥éª¤å’Œè¾¹ç¼˜æƒ…å†µç¼–å†™ä»£ç ï¼Œ**åªéœ€è¦ç»™ Agent ä¸€ä¸ªç›®æ ‡å’Œä¸€ç³»åˆ—çš„è½¬æ¢ï¼Œè®© LLM å®æ—¶åšå‡ºå†³ç­–æ¥ç¡®å®šè·¯å¾„**

> è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œä½ ç¼–å†™çš„æ¨¡å—æ›´å°‘äº†ï¼Œåªéœ€å°†å›¾çš„â€œè¾¹ç¼˜â€äº¤ç»™ LLMï¼Œè®©å®ƒè‡ªå·±å¤„ç†èŠ‚ç‚¹ï¼Œç”šè‡³ä¼šå‘ç°æœ‰æ—¶å€™ LLM ä¸ºé—®é¢˜æ‰¾åˆ°äº†æ–°çš„è§£å†³æ–¹æ¡ˆ
>

**è¿™ç§æ–¹å¼å…¶å®å°±æ˜¯æŠŠå¾ªç¯å’Œæ¡ä»¶åˆ¤æ–­ç»Ÿä¸€äº¤ç»™ LLM æ¥é©±åŠ¨**



Excalidraw æ–‡ä»¶ï¼š[https://gcntfv628ebr.feishu.cn/file/TK9Lb7mI7o2RrWx7yhLc8tlGn5d](https://gcntfv628ebr.feishu.cn/file/TK9Lb7mI7o2RrWx7yhLc8tlGn5d)

![LLMç³»ç»Ÿè®¾è®¡æ ¸å¿ƒ](./image/image%20(12).png)

Agent ç³»ç»Ÿçš„æ ¸å¿ƒæ­¥éª¤

1. LLM å†³å®šå·¥ä½œæµç¨‹ä¸­çš„ä¸‹ä¸€æ­¥ï¼Œè¾“å‡ºâ€œå·¥å…·è°ƒç”¨â€
2. ç¡®å®šæ€§ä»£ç æ‰§è¡Œå·¥å…·è°ƒç”¨
3. å·¥å…·æ‰§è¡Œç»“æœè¿½åŠ åˆ°ä¸Šä¸‹æ–‡ä¸­
4. é‡å¤ç›´åˆ°ä¸‹ä¸€ä¸ªæ­¥éª¤ç¡®å®šä¸ºâ€œå®Œæˆâ€

**å·¥å…·è°ƒç”¨çš„èƒ½åŠ›ï¼Œå°† Agent ç³»ç»Ÿä¸­çš„ä¸ç¡®å®šæ€§çš„ LLM æµç¨‹è½¬æ¢ä¸ºç¡®å®šæ€§çš„ä»£ç æ‰§è¡Œ**

## 3.2ã€æ§åˆ¶æµ
æ§åˆ¶æµçš„æ–¹å¼å¯ä»¥ä¸ºå·¥å…·è°ƒç”¨æ·»åŠ æ›´å¤šçš„åˆ†æ”¯æ§åˆ¶ï¼Œè®©å·¥å…·è°ƒç”¨ä¸ä»…ä»…æ˜¯ä¸€æ¬¡å‡½æ•°æ‰§è¡Œï¼Œè€Œæ˜¯ä¸€æ¬¡å®Œæ•´çš„æµç¨‹è°ƒç”¨ï¼Œ**æ‰€ä»¥å­¦ä¼šä½¿ç”¨æ§åˆ¶æµæ¥æ„å»ºå·¥å…·è°ƒç”¨ï¼Œä¼šå‘ç”Ÿéå¸¸å¤šæœ‰è¶£çš„äº‹æƒ…**

ä¾‹å¦‚ï¼š

1. æ™®é€šçš„å·¥å…·è°ƒç”¨ï¼šä¸€æ¬¡æ‰§è¡Œï¼ŒæŸ¥è¯¢å¤©æ°”ç»“æœï¼Œå°†ç»“æœè¿”å›ç»™æ¨¡å‹

2. æ§åˆ¶æµçš„å·¥å…·è°ƒç”¨ï¼šä¼šæ£€æµ‹è¯¥å·¥å…·è°ƒç”¨æ˜¯å¦æ˜¯â€œé«˜é£é™©â€ï¼Œå¦‚ï¼šæˆ‘è¦éƒ¨ç½²åç«¯æœåŠ¡ï¼Œè¿™ä¸ªæ—¶å€™æ£€æµ‹åˆ°è¯¥å·¥å…·è°ƒç”¨æ—¶é«˜é£é™©ï¼Œä¼šè¿›å…¥äººå·¥å®¡æ ¸åˆ¤æ–­ï¼Œ

+ å…ˆä¿å­˜ä¸Šä¸‹æ–‡
+ ç»™ç”¨æˆ·å‘å®¡æ‰¹é€šçŸ¥
+ ç­‰å¾…ç”¨æˆ·çš„å®¡æ‰¹ç»“æœ
+ ç”¨æˆ·åŒæ„ï¼Œå‡½æ•°æ‰§è¡Œ



ä½¿ç”¨æ§åˆ¶æµï¼Œä½ éœ€è¦ä¸ºç‰¹å®šçš„ä¾‹å­æ„å»ºç‹¬ç‰¹çš„æ§åˆ¶ç»“æ„ï¼Œå…·ä½“æ¥è¯´ï¼ŒæŸäº›å·¥å…·è°ƒç”¨ä¼šè·³å‡ºå¾ªç¯å¹¶ç­‰å¾…äººç±»æˆ–å…¶ä»–é•¿æ—¶é—´çš„ä»»åŠ¡ï¼ˆå¦‚è®­ç»ƒç®¡é“ï¼‰çš„å“åº”ï¼Œåç»­ä½ å¯èƒ½è¿˜ä¼šä½¿ç”¨å…¶ä»–çš„è‡ªå®šä¹‰å®ç°

1. å·¥å…·è°ƒç”¨ç»“æœè¿›è¡Œæ‘˜è¦ç¼“å­˜
2. LLM è¾…åŠ©ç»“æ„åŒ–è¾“å‡º
3. ä¸Šä¸‹æ–‡å‹ç¼©æˆ–å†…å­˜ç®¡ç†
4. æ—¥å¿—è®°å½•ã€è·Ÿè¸ªå’ŒæŒ‡æ ‡ç»Ÿè®¡
5. æŒä¹…æš‚åœå’Œç­‰å¾…



æ§åˆ¶æµæœ‰ä¸‰ç§æ¨¡å¼

+ **è¯·æ±‚ä¿¡æ¯è¡¥å……**ï¼šæ¨¡å‹è¯·æ±‚æ›´å¤šçš„ä¿¡æ¯ï¼Œè¿™ä¸ªæ—¶å€™ä¼šä¸­æ–­å¾ªç¯ç­‰å¾…äººç±»å›å¤
+ **è·å–ä¿¡æ¯**ï¼šä¾‹å¦‚ï¼šè¯·æ±‚ git æ ‡ç­¾ï¼Œè·å–æ ‡ç­¾ä¹‹åè¿½åŠ åˆ°ä¸Šä¸‹æ–‡ä¸­ï¼Œç„¶åè¿”å›ç»™æ¨¡å‹
+ **è¯·æ±‚å®¡æ‰¹ï¼šå½“å‡ºç°â€œé«˜é£é™©æ“ä½œâ€çš„æ—¶å€™ï¼Œæ¨¡å‹ä¼šè¯·æ±‚ç”¨æˆ·è¿›è¡Œå®¡æ‰¹ï¼Œæ ¹æ®ç”¨æˆ·çš„é€‰æ‹©æ¥æ‰§è¡Œä¸åŒçš„æµç¨‹**



ğŸŒŸ **å·¥å…·çš„è°ƒç”¨æ„å»ºï¼Œä¸è¦åªåœç•™åœ¨å‡½æ•°æ‰§è¡Œï¼Œè€Œæ˜¯è¦æœ‰â€œæ§åˆ¶æµâ€çš„æ€ç»´ï¼Œä»¥æ­¤æ­å¼€å·¥å…·è°ƒç”¨æ›´å¤šçš„ LLM ç©æ³•ï¼Œå¹¶ä¸”æ§åˆ¶æµæ„å»ºåˆç†ï¼Œå¯ä»¥æ›¿ä»£ä½¿ç”¨ LangGraph çš„å·¥ä½œæµæ„å»ºæ–¹å¼**

## 3.3ã€è¾…åŠ©ç»“æ„åŒ–è¾“å‡º
æˆ‘ä»¬éœ€è¦å¤§æ¨¡å‹è¾“å‡º JSON æ ¼å¼çš„æ—¶å€™ï¼Œä¼šåœ¨æç¤ºè¯é‡Œé¢æ§åˆ¶å¤§æ¨¡å‹è¾“å‡ºç»“æœï¼Œä¾‹å¦‚ï¼š

> â€œè¾“å‡ºç»“æœä¸€å®šè¦æ˜¯JSONæ ¼å¼ï¼Œå­—æ®µè¦æ±‚ï¼šxxxã€xxxxã€xxxxâ€
>

è¿™ä¸ªæ—¶å€™å¤§æ¨¡å‹å¤§éƒ¨åˆ†æƒ…å†µä¸‹è¾“å‡ºçš„æ•ˆæœè¿˜æ˜¯å¯ä»¥çš„ï¼Œå¦‚æœè¦è®©æ•ˆæœæ›´åŠ ç¨³å®šï¼Œæˆ‘ä»¬éœ€è¦èŠ±ä¸€ç‚¹å¿ƒæ€åœ¨æç¤ºè¯çš„ä¼˜åŒ–ä¸Šé¢ã€‚



ä½†æ˜¯æˆ‘ä»¬è¿˜æœ‰å¦å¤–ä¸€ç§æ€è·¯ï¼š**ä½¿ç”¨å·¥å…·è°ƒç”¨çš„æ–¹å¼æ¥è¾¾åˆ°ç»“æ„åŒ–è¾“å‡ºçš„ç›®çš„**

åœ¨ Function Call çš„æ¨¡å¼ä¸‹ï¼Œè¾“å‡ºçš„ç»“æœè‡ªç„¶å°±æ˜¯ JSONï¼Œå·¥å…·è°ƒç”¨çš„åç§°å’Œå‚æ•°çš„ JSON æ ¼å¼

ğŸš€ **é‚£ä¹ˆæ˜¯ä¸æ˜¯å¯ä»¥æ€è€ƒä¸€ä¸‹ï¼Œæˆ‘è®¾ç½®äº†ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°çš„æ‰§è¡Œç»“æœä¸ºç©ºï¼Œæ‰§è¡Œä»£ç æ— ï¼Œå› ä¸ºè¿™ä¸ªå‡½æ•°å°±æ˜¯ç”¨æ¥è¾“å‡º JSON æ ¼å¼çš„å‚æ•°åˆ—è¡¨çš„ï¼Œ**

**è¿™ä¸ªå‚æ•°åˆ—è¡¨å°±æ˜¯æˆ‘éœ€è¦çš„ç»“æœï¼Œè€Œä¸æ˜¯å·¥å…·è°ƒç”¨ä¹‹åè¿”å›çš„ç»“æœ**

****

ä¾‹å¦‚ç°åœ¨æœ‰ä¸€ä¸ªä½¿ç”¨ LLM è¿›è¡Œæ€»ç»“æ‘˜è¦çš„åŠŸèƒ½

```typescript
//æ–¹å¼Aï¼šæç¤ºè¯æ§åˆ¶ç»“æ„åŒ–è¾“å‡º
const prompt = `
è¯·æ€»ç»“ä»¥ä¸‹å†…å®¹ï¼Œè¾“å‡ºå¿…é¡»æ˜¯ JSONï¼š
{
  "title": "...",
  "key_points": ["...", "..."],
  "sentiment": "positive | neutral | negative"
}
å†…å®¹ï¼š${inputText}
`;

// æ¨¡å‹å¤§æ¦‚ç‡ä¼šè¿”å› JSON å­—ç¬¦ä¸²
const raw = await llm.chat(prompt);
const result = JSON.parse(raw);
console.log(result);


//æ–¹å¼Bï¼šå·¥å…·è°ƒç”¨è¾…åŠ©ç»“æ„åŒ–è¾“å‡º
// å®šä¹‰ä¸€ä¸ªâ€œå‡çš„å·¥å…·â€ï¼Œåªè¦å‚æ•°ï¼Œä¸å…³å¿ƒæ‰§è¡Œ
const tools = [{
  name: "summarize_text",
  description: "æŠŠæ–‡æœ¬æ€»ç»“ä¸º JSON",
  parameters: {
    type: "object",
    properties: {
      title: { type: "string" },
      key_points: { type: "array", items: { type: "string" } },
      sentiment: { type: "string" }
    },
    required: ["title", "key_points", "sentiment"]
  }
}];

// è®©æ¨¡å‹è°ƒç”¨å·¥å…·
const res = await llm.chatWithTools({
  user: `è¯·æ€»ç»“ï¼š${inputText}`,
  tools,
  tool_choice: "summarize_text" // å¼ºåˆ¶ç”¨å·¥å…·
});

// æ‹¿åˆ°å·¥å…·çš„å‚æ•° = æˆ‘ä»¬è¦çš„ JSON
const args = JSON.parse(res.tool_calls[0].arguments);
console.log(args);

```

æ–¹å¼ Aï¼šä½¿ç”¨æç¤ºè¯æ§åˆ¶å¤§æ¨¡å‹è¾“å‡ºç›¸åº”çš„ JSON ç»“æ„

æ–¹å¼ Bï¼šä½¿ç”¨å·¥å…·è°ƒç”¨è®©å¤§æ¨¡å‹è¾“å‡ºâ€œå·¥å…·å‚æ•°â€çš„ JSON ç»“æ„ï¼Œä»£ç è¿›è¡Œæå–



# å››ã€å·¥å…·çš„é”™è¯¯å¤„ç†
æ— è®ºä½ å·¥å…·å®šä¹‰çš„å¤šå¥½ï¼ŒLLM çš„æ¨ç†èƒ½åŠ›å¤šå¼ºï¼Œéƒ½æ˜¯æœ‰å¯èƒ½ä¼šå‡ºç°å·¥å…·è°ƒç”¨é”™è¯¯çš„ï¼Œè¿™ç§é”™è¯¯ä¼šè®© Agent ç³»ç»Ÿä¸å¤Ÿç¨³å®šï¼Œä½†æ˜¯å¥½åœ¨ LLM æœ‰â€œè‡ªæˆ‘ä¿®å¤â€çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥å°†é”™è¯¯ä¿¡æ¯åŠ åˆ° LLM çš„ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨èµ·æ¥ï¼Œå‘æŒ¥ LLM çš„â€œè‡ªç”±ä¿®å¤â€èƒ½åŠ›



ç›®å‰çš„å·¥å…·è°ƒç”¨å¯èƒ½å‡ºç°çš„é—®é¢˜å¤§æ¦‚æœ‰ä¸¤ç§ï¼š

1. è°ƒç”¨å·¥å…·å‰è¿›è¡Œå‚æ•°éªŒè¯ - ç”¨äºæ”¶é›† LLM è¾“å‡ºå·¥å…·å‚æ•°é”™è¯¯
2. è¿˜æœ‰ä¸€ç§æ˜¯å·¥å…·è°ƒç”¨æœŸé—´çš„é”™è¯¯äº‹ä»¶ï¼Œä¾‹å¦‚ç½‘ç»œæƒ…å†µ-è§¦å‘é‡è¯•æœºåˆ¶ï¼Œä¾‹å¦‚å·¥å…·æŒ‘é€‰é”™è¯¯ï¼Œä¹Ÿå¯ä»¥å°†é”™è¯¯ä¿¡æ¯è¾“å…¥

å½“è§¦å‘ LLM é”™è¯¯ä¿®å¤çš„æœºåˆ¶çš„æ—¶å€™ï¼Œ**è¦è®¾ç½®ä¸€ä¸ªæœ€å¤§å¾ªç¯ä¿®å¤æ¬¡æ•°**ï¼Œä¸ç„¶ LLM ä¼šåœ¨é”™è¯¯ä¸­æ— é™å¾ªç¯

## 4.1ã€å·¥å…·è°ƒç”¨å‚æ•°é”™è¯¯å¤„ç†æœºåˆ¶
å½“ä½ åœ¨è®¾ç½®å·¥å…·æ‰§è¡Œå‡½æ•°çš„é€»è¾‘çš„æ—¶å€™ï¼Œè€ƒè™‘åœ¨å·¥å…·æ‰§è¡Œæ ¸å¿ƒé€»è¾‘ä¹‹å‰ï¼Œè¿›è¡Œå‚æ•°éªŒè¯ï¼Œåƒ API æ¥å£é‚£æ ·çš„å‚æ•°éªŒè¯ï¼Œå¹¶ä¸”å¯¹äºå‚æ•°éªŒè¯å‡ºç°çš„é”™è¯¯ä¿¡æ¯è¦å¥½å¥½è®¾è®¡ï¼Œå› ä¸ºè¿™ä¸ªæ˜¯ LLM è¿›è¡Œé”™è¯¯ä¿®å¤æ—¶çš„â€œæŒ‡è·¯ç¯â€



å·¥å…·æ‰§è¡Œé”™è¯¯å¤„ç†æœºåˆ¶ï¼š

1. éªŒè¯å‚æ•°å¤±è´¥ï¼šç³»ç»Ÿæ£€æµ‹åˆ°æœªå®šä¹‰çš„å‚æ•°æˆ–è€…å‚æ•°ç±»å‹é”™è¯¯ã€å‚æ•°ç¼ºå¤±
2. é”™è¯¯åé¦ˆï¼šå°†è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯è¿”å›ç»™ LLMï¼Œä¾‹å¦‚
    1. å‚æ•°éªŒè¯å¤±è´¥-'profile'å¯¹è±¡åŒ…å«æœªå®šä¹‰çš„å±æ€§'birthday'ï¼Œè¯¥å±æ€§åœ¨schemaä¸­ä¸å…è®¸ã€‚å…è®¸çš„å±æ€§æœ‰ï¼š'name'ï¼ˆå¿…éœ€ï¼‰ã€'email'ï¼ˆå¿…éœ€ï¼‰ã€'age'ï¼ˆå¯é€‰ï¼‰ã€‚è¯·ç§»é™¤'birthday'å±æ€§å¹¶é‡è¯•
3. ä¸Šä¸‹æ–‡æ›´æ–°ï¼šå°†é”™è¯¯ä¿¡æ¯æ·»åŠ åˆ°å¯¹è¯å†å²ä¸­
4. LLM å­¦ä¹ ï¼šLLM ä»é”™è¯¯ä¿¡æ¯ä¸­å­¦ä¹ æ­£ç¡®çš„å‚æ•°ç»“æ„
5. ç¬¬äºŒæ¬¡å°è¯•ï¼šLLM ç”Ÿæˆä¿®æ­£åçš„å‚æ•°
6. éªŒè¯æˆåŠŸï¼šä¿®æ­£åçš„å‚æ•°é€šè¿‡éªŒè¯ï¼Œæ‰§è¡Œå·¥å…·å‡½æ•°



```typescript
// å·¥å…·é”™è¯¯å¤„ç†æœºåˆ¶æ ¸å¿ƒä»£ç 
function validateTool(params) {
  const allowed = ['name', 'email', 'age'];
  const invalid = Object.keys(params).find(p => !allowed.includes(p));
  if (invalid) {
    throw new Error(`å‚æ•°éªŒè¯å¤±è´¥-'profile'å¯¹è±¡åŒ…å«æœªå®šä¹‰çš„å±æ€§'${invalid}'ï¼Œå…è®¸çš„å±æ€§æœ‰ï¼š'name'ï¼ˆå¿…éœ€ï¼‰ã€'email'ï¼ˆå¿…éœ€ï¼‰ã€'age'ï¼ˆå¯é€‰ï¼‰ã€‚è¯·ç§»é™¤'${invalid}'å±æ€§å¹¶é‡è¯•`);
  }
}

async function executeTool(params) {
  try {
    validateTool(params);
    return 'âœ… æ‰§è¡ŒæˆåŠŸ';
  } catch (error) {
    console.log('âŒ é”™è¯¯:', error.message);
    
    // LLMä»é”™è¯¯ä¸­å­¦ä¹ å¹¶ä¿®æ­£å‚æ•°
    const corrected = { ...params };
    delete corrected.birthday;
    
    console.log('ğŸ¤– LLMé‡è¯•ä¿®æ­£åçš„å‚æ•°:', corrected);
    validateTool(corrected);
    return 'âœ… ä¿®æ­£åæ‰§è¡ŒæˆåŠŸ';
  }
}

```

## 4.2ã€å·¥å…·é”™è¯¯é‡è¯•æœºåˆ¶
å°†é”™è¯¯ä¿¡æ¯åŠ å…¥åˆ°ä¸Šä¸‹æ–‡ï¼ˆContextï¼‰ä¸­ä¹‹åï¼ŒLLM ä¼šå‚è€ƒé”™è¯¯ä¿¡æ¯è¿›è¡Œâ€œè‡ªæˆ‘ä¿®å¤â€

**ä½†æ˜¯ä¸è¦é™·å…¥åˆ°æ— é™çš„é”™è¯¯ä¿®å¤å¾ªç¯ä¸­ï¼Œè¦åŠ å…¥é™åˆ¶æœºåˆ¶ï¼Œ**

ä¾‹å¦‚ï¼šé™åˆ¶å•ä¸ªå·¥å…·æœ€å¤š 3 æ¬¡å°è¯•ï¼Œä¹‹åç¨‹åºä¸­æ–­ï¼Œæˆ–è€…è®©å¤§æ¨¡å‹å°†é”™è¯¯å‡ºç°çš„åŸå› å›å¤ç»™ç”¨æˆ·ï¼Œè¾…åŠ©ç”¨æˆ·è¿›è¡Œæ’æŸ¥

<font style="color:rgb(31, 35, 40);"></font>

<font style="color:rgb(31, 35, 40);">å¦‚æœä¸åŠ é™åˆ¶ä½ ä¼šå‘ç°ï¼Œä»£ç†ä¼šä¸€ç›´å¾ªç¯ï¼Œä¸€éåˆä¸€éçš„é‡å¤åŒæ ·çš„é”™è¯¯ï¼Œå¯¼è‡´è¿™ä¸€ä¸ªçš„åŸå› æœ‰å¤šç§ï¼š</font>

+ LLM ç†è§£èƒ½åŠ›é™åˆ¶
+ ä¸Šä¸‹æ–‡æ··ä¹±
+ ç¼ºä¹æ›¿ä»£ç­–ç•¥ï¼šLLM ä¸çŸ¥é“é™¤äº†é‡è¯•è¿˜èƒ½åšä»€ä¹ˆ

é‚£ä¹ˆç›¸åº”çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼š

1. æ§åˆ¶æµæ¥ç®¡ï¼šé€šè¿‡ç¡®å®šçš„ç¨‹åºæ¥ä¸»åŠ¨å¹²é¢„ï¼Œè€Œä¸æ˜¯å®Œå…¨ä¾èµ– LLM åˆ¤æ–­
2. ä¸Šä¸‹æ–‡ç®¡ç†ï¼šé‡ç»„æˆ–åˆ é™¤é”™è¯¯ä¿¡æ¯ï¼Œé¿å…ä¸Šä¸‹æ–‡æ±¡æŸ“ï¼Œä½ ä¹Ÿå¯ä»¥é‡æ–°æ•´ç†é”™è¯¯ä¿¡æ¯ï¼Œè®©é”™è¯¯ä¿¡æ¯ï¼šæ˜ç¡®ï¼Œå¹²å‡€ï¼Œæœ‰æ•ˆ
3. ä½¿ç”¨å°è€Œä¸“æ³¨çš„ Agentï¼šå‡å°‘å¤æ‚æ€§ï¼Œé™ä½é”™è¯¯æ¦‚ç‡





# äº”ã€å·¥å…·çš„åˆ†ç±»
å·¥å…·å¤§è‡´å¯ä»¥å½’ä¸ºä¸‰ç±»

1. **æ•°æ®ç±»ï¼ˆDataï¼‰ï¼š**
    1. è·å–ä¸Šä¸‹æ–‡ä¸ä¿¡æ¯ï¼Œæ”¯æ’‘æµç¨‹å†³ç­–
    2.  ç¤ºä¾‹ï¼šæŸ¥è¯¢æ•°æ®åº“ã€è¯»å– PDFã€æœç´¢ç½‘é¡µ
2. **åŠ¨ä½œç±»ï¼ˆActionï¼‰**
    1. åœ¨ç³»ç»Ÿä¸­æ‰§è¡Œæ“ä½œï¼Œæ¨åŠ¨æµç¨‹å‘å‰
    2.  ç¤ºä¾‹ï¼šå‘é‚®ä»¶ã€æ›´æ–° CRMã€è½¬äº¤å®¢æœè¯·æ±‚
3. **ç¼–æ’ç±»ï¼ˆOrchestrationï¼‰**
    1. æ™ºèƒ½ä½“å¯ä½œä¸ºå¦ä¸€ä¸ªæ™ºèƒ½ä½“çš„â€œå·¥å…·â€ä½¿ç”¨ï¼Œå®ç°æ›´é«˜çº§çš„åè°ƒ
    2.  ç¤ºä¾‹ï¼šé€€æ¬¾æ™ºèƒ½ä½“ã€ç ”ç©¶æ™ºèƒ½ä½“ã€å†™ä½œæ™ºèƒ½ä½“

